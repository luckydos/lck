<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>교육청 사이트 스크랩 JS 테스트</title>
	<style>
		/* 사용자 지정 스타일 유지 */
		body { font-family: sans-serif; padding: 20px; }
		.container { max-width: 800px; margin: 0 auto; }
		h3.tit1 { color: #333; border-bottom: 2px solid #ccc; padding-bottom: 5px; }
		h4.tit2 { color: #555; margin-top: 20px; }
		.result-box {
			background-color: #ffe0e0; /* 실패 예상 시각화 */
			border: 2px solid #ff4d4d;
			padding: 15px;
			margin-top: 10px;
			white-space: pre-wrap;
			word-break: break-all;
			min-height: 100px;
			color: #a00;
		}
		.success-box {
			background-color: #e6ffe6;
			border: 2px solid #4CAF50;
			color: #008000;
		}
		.btn-test { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; }
	</style>
</head>
<body>
	<div class="container">
		<h3 class="tit1">❌ 교육청 사이트 JS 스크랩 테스트 (CORS 실패 예상)</h3>
		<p>이 코드는 브라우저 보안 정책(CORS)에 의해 차단될 것입니다. 결과를 확인하려면 **개발자 도구 (F12)의 Console 탭**을 확인하세요.</p>

		<button class="btn-test" onclick="testGyo6Board()">스크랩 요청 시작</button>

		<h4 class="tit2">요청 상태</h4>
		<div id="status" class="result-box">대기 중...</div>

		<h4 class="tit2">수신 데이터</h4>
		<div id="result-data" class="result-box">데이터를 수신하면 여기에 표시됩니다. (성공 시에만)</div>
	</div>

	<script>
		// 탭(tab) 간격 들여쓰기 적용
		function testGyo6Board() {
			// **주의:** 이 URL은 실제 게시물 목록을 가져오는 AJAX API URL로 수정해야 합니다.
			const API_URL = 'https://school.gyo6.net/help/na/ntt/selectNttList.do'; 
			
			const statusElement = document.getElementById('status');
			const resultElement = document.getElementById('result-data');
			
			statusElement.textContent = 'API (' + API_URL + ')에 요청 중...';
			resultElement.textContent = '데이터를 기다리는 중...';
			resultElement.className = 'result-box'; // 초기화

			// POST 요청에 필요한 데이터 (실제 파라미터 확인 필수)
			const payload = {
				'mi': '136612',
				'bbsId': '41250',
				'pageIndex': 1,
				'rowPerPage': 10
			};
			
			// URLSearchParams를 사용하여 POST 데이터를 URL-encoded 형식으로 변환
			const formData = new URLSearchParams(payload).toString();

			fetch(API_URL, {
				method: 'POST',
				headers: {
					// 요청이 POST임을 알림
					'Content-Type': 'application/x-www-form-urlencoded',
				},
				body: formData // POST 본문에 데이터 포함
			})
			.then(response => {
				const statusCode = response.status;
				
				if (!response.ok) {
					// 200번대가 아닌 HTTP 오류 처리 (CORS 오류는 여기서 잡히지 않음)
					statusElement.textContent = '❌ 요청 실패: HTTP 상태 코드 ' + statusCode;
					throw new Error('HTTP 응답 오류: ' + response.statusText);
				}
				
				statusElement.textContent = '⚠️ 요청은 성공했으나, JSON 파싱 시도 중... 상태 코드 ' + statusCode;

				return response.text(); // JSON이 아닌 HTML을 반환할 수 있으므로, 일단 텍스트로 받습니다.
			})
			.then(responseText => {
				statusElement.textContent = '❌ CORS 차단 없이 응답을 받았지만, 데이터 분석 필요.';
				resultElement.textContent = '수신된 데이터 (HTML/JSON): \n\n' + responseText.substring(0, 500) + '... (길어서 생략)';
				resultElement.className = 'result-box success-box';
				
				// 실제로는 여기서 HTML을 DOM 파싱하거나 JSON을 분석해야 함
				console.log("Full Response:", responseText);

			})
			.catch(error => {
				// 네트워크 오류나 CORS 차단, 혹은 .then() 내부에서 발생한 오류를 잡음
				statusElement.textContent = '❌ 요청 완전히 실패 (CORS 차단 또는 네트워크 오류 발생)';
				resultElement.textContent = '오류 메시지: ' + error.message + '\n\n**개발자 도구(F12)의 Console 탭을 확인하세요.**';
				resultElement.className = 'result-box';
				console.error("Fetch Error:", error);
			});
		}
	</script>
</body>
</html>
