<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>API 통신 테스트 (GitHub Pages)</title>
	<style>
		body { font-family: sans-serif; padding: 20px; }
		.container { max-width: 600px; margin: 0 auto; }
		h3.tit1 { color: #333; border-bottom: 2px solid #ccc; padding-bottom: 5px; }
		h4.tit2 { color: #555; margin-top: 20px; }
		.result-box {
			background-color: #f4f4f4;
			border: 1px solid #ddd;
			padding: 15px;
			margin-top: 10px;
			white-space: pre-wrap;
			word-break: break-all;
			min-height: 100px;
		}
	</style>
</head>
<body>
	<div class="container">
		<h3 class="tit1">✅ GitHub Pages API 통신 테스트</h3>
		<p>아래 버튼을 클릭하여 외부 테스트 API 서버로부터 데이터를 가져옵니다.</p>

		<button onclick="testApiFetch()">테스트 API 요청 시작</button>

		<h4 class="tit2">요청 상태</h4>
		<div id="status" class="result-box">대기 중...</div>

		<h4 class="tit2">수신 데이터 (최신 게시물 1개 가정)</h4>
		<div id="result-data" class="result-box"></div>
	</div>

	<script>
		// 탭(tab) 간격 들여쓰기 적용
		function testApiFetch() {
			const apiUrl = 'https://jsonplaceholder.typicode.com/posts/1';
			const statusElement = document.getElementById('status');
			const resultElement = document.getElementById('result-data');
			
			statusElement.textContent = 'API (' + apiUrl + ')에 요청 중...';
			resultElement.textContent = '데이터를 기다리는 중...';

			// Fetch API를 사용하여 외부 데이터 가져오기
			fetch(apiUrl)
			.then(response => {
				// 1. 요청 상태 확인 및 출력 (response 변수를 여기서 사용)
				const statusCode = response.status;
				
				if (!response.ok) {
					statusElement.textContent = '❌ 요청 실패: 상태 코드 ' + statusCode + '. 네트워크 응답 오류: ' + response.statusText;
					throw new Error('네트워크 응답 오류');
				}
				
				// 성공했을 경우 상태 출력
				statusElement.textContent = '✅ 요청 성공: 상태 코드 ' + statusCode;

				return response.json(); // 응답 본문을 JSON으로 파싱하여 다음 .then()으로 전달
			})
			.then(data => {
				// 2. 파싱된 데이터 (data)를 처리
				// JSON.stringify(data, null, 2)를 사용하여 예쁘게 출력
				resultElement.textContent = JSON.stringify(data, null, 2);
				
			})
			.catch(error => {
				// 3. 이전 단계(then, fetch 등)에서 발생한 모든 오류를 처리
				if (error.message !== '네트워크 응답 오류') {
					statusElement.textContent = '❌ 요청 실패: ' + error.message;
					resultElement.textContent = '오류가 발생했습니다. 브라우저 콘솔을 확인해 보세요.';
					console.error("API Fetch Error:", error);
				}
			});
		}
	</script>
</body>
</html>
